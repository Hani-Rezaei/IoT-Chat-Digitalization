<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>TextYourIoTDevice: 🌐 &lt;strong&gt;TextYourIoTDevice&lt;/strong&gt;</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">TextYourIoTDevice<span id="projectnumber">&#160;V_1.0.0</span>
   </div>
   <div id="projectbrief">This project demonstrates how to connect a Nordic nRF52840 Development Kit (DK) to AWS IoT Core via an MQTT broker (Mosquitto)</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">🌐 &lt;strong&gt;TextYourIoTDevice&lt;/strong&gt;</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md15"></a> This project demonstrates how to connect a Nordic nRF52840 Development Kit (DK) to AWS IoT Core via an MQTT broker (Mosquitto) and integrate a Telegram bot for interaction and notifications. The system uses LEDs for status indication and includes logging and monitoring capabilities through AWS CloudWatch.</p>
<hr  />
<h1><a class="anchor" id="autotoc_md17"></a>
📚 &lt;strong&gt;Table of Contents&lt;/strong&gt;</h1>
<ol type="1">
<li>Project Overview</li>
<li>System Architecture</li>
<li>Features</li>
<li>Requirements</li>
<li>Project structure</li>
<li>Setup Instructions<ul>
<li>1. Flashing the DK</li>
<li>2. Flashing the Dongle</li>
<li>3. The MQTT Broker on AWS EC2</li>
<li>4. The MQTT Broker on AWS IoT Core</li>
<li>5. The AWS Lambda TelegramBotHandler</li>
<li>6. The AWS API Gateaway</li>
<li>7. The Webhook</li>
<li>8. Telegram Bot</li>
</ul>
</li>
<li>Documentation</li>
<li>Contact</li>
</ol>
<hr  />
<h1><a class="anchor" id="autotoc_md19"></a>
📜 &lt;strong&gt;Project Overview&lt;/strong&gt;</h1>
<p>This project enables IoT devices to communicate with AWS IoT Core using the MQTT protocol. A Telegram bot is integrated to provide a user interface for sending and receiving messages. <br  />
 The primary use case involves a DK that collects sensor data, sends it to an MQTT broker (Mosquitto), which forwards it securely to AWS IoT Core using TLS encryption. The system supports feedback loops via Telegram bot interaction.</p>
<hr  />
<h1><a class="anchor" id="autotoc_md21"></a>
📐 &lt;strong&gt;System Architecture&lt;/strong&gt;</h1>
<p><img src="images/architecture.png" alt="architecture" class="inline"/> </p>
<h2><a class="anchor" id="autotoc_md22"></a>
&lt;strong&gt;Components:&lt;/strong&gt;</h2>
<ol type="1">
<li><b>Sensor BME280:</b> Temperature, air pressure and humidity sensor</li>
<li><b>nRF52840 DK:</b> Publishes sensor data via MQTT.</li>
<li><b>nRF52840 Dongle:</b> Functions as a border router for the DK.</li>
<li><b>Mosquitto (MQTT Broker):</b> Acts as an intermediary between the DK and AWS IoT Core.</li>
<li><b>AWS IoT Core:</b> Central hub for IoT device communication.</li>
<li><b>AWS Lamda:</b></li>
<li><b>AWS API Gateaway:</b></li>
<li><b>Webhook:</b> </li>
</ol>
<h1><a class="anchor" id="autotoc_md23"></a>
9. &lt;strong&gt;Telegram Bot:&lt;/strong&gt; Allows interaction with the IoT system.</h1>
<h1><a class="anchor" id="autotoc_md24"></a>
✨ &lt;strong&gt;Features&lt;/strong&gt;</h1>
<ul>
<li><b>End-to-End Encryption:</b> TLS ensures secure communication between Mosquitto and Telegram bot.</li>
<li><b>Status Indicators:</b> LEDs on the DK signal connection status and data transfer.</li>
<li><b>Interactive Telegram Bot:</b> Receive and send messages through a Telegram bot.</li>
<li><b>Logging and Monitoring:</b> </li>
</ul>
<h1><a class="anchor" id="autotoc_md25"></a>
Implement logging for debugging and monitoring IoT devices using AWS CloudWatch</h1>
<h1><a class="anchor" id="autotoc_md26"></a>
🛠️ &lt;strong&gt;Requirements&lt;/strong&gt;</h1>
<h2><a class="anchor" id="autotoc_md27"></a>
&lt;strong&gt;Hardware:&lt;/strong&gt;</h2>
<ul>
<li>Nordic nRF52840 DK</li>
<li>nRF52840 Dongle (used as a border router)</li>
<li>Raspberry Pi (optional for border router setup)</li>
<li>Sensor BME280 (If the sensor is not connected, only the value of the internal sensor can be read from the DK)</li>
</ul>
<h2><a class="anchor" id="autotoc_md28"></a>
&lt;strong&gt;Software:&lt;/strong&gt;</h2>
<ul>
<li>RIOT OS with <code>paho_mqtt</code> running on the DK</li>
<li>RIOT OS with <code>gnrc_border_router</code> running on the Dongle</li>
<li>Mosquitto MQTT Broker installed on an AWS EC2 instance <br  />
</li>
<li>AWS IoT Core configured for MQTT communication</li>
<li></li>
<li></li>
<li></li>
<li></li>
<li>Telegram Bot API <br  />
</li>
</ul>
<h2><a class="anchor" id="autotoc_md29"></a>
&lt;strong&gt;Certificates and Keys:&lt;/strong&gt;</h2>
<ul>
<li>AWS IoT Core Root CA certificate "*AmazonRootCA.pem*"</li>
<li>Device certificate "*certificate.pem.crt*"</li>
<li>private key "*private.pem.key*"</li>
</ul>
<h2><a class="anchor" id="autotoc_md30"></a>
&lt;strong&gt;Tools:&lt;/strong&gt;</h2>
<ul>
<li><a href="https://filezilla-project.org/download.php">FileZilla</a>: SSH client for AWS EC2 </li>
</ul>
<h1><a class="anchor" id="autotoc_md31"></a>
- &lt;a href="https://www.nordicsemi.com/Products/Development-tools/nRF-Connect-for-Desktop/Download#infotabs" &gt;nRF Connect for Desktop&lt;/a&gt; : For flashing the firmware in Dongle</h1>
<h1><a class="anchor" id="autotoc_md32"></a>
📂 &lt;strong&gt;Project structure&lt;/strong&gt;</h1>
<p>The following is an overview of the project's structure:</p>
<div class="fragment"><div class="line">TextYourIoTDevice/</div>
<div class="line">├── aws/                        # Contains configuration from AWS such as security certificates project.</div>
<div class="line">│   ├── AWS_EC2_Conf/           # Configurations of AWS EC2</div>
<div class="line">│   ├── AWS_IoTCore_TLS_Conf/   # Configurations of AWS IoT Core and TLS certificates</div>
<div class="line">│   ├── Lambda/                 # Lambda functions </div>
<div class="line">├── Board_Datasheet/            # Contains the datasheets of the board and sensors</div>
<div class="line">├── Dongle/                     # Contains the code that is flashed on the dongle as a border router and the IPv6-address of dongle </div>
<div class="line">│   ├── gnrc_border_router/     # The code of gnrc_border_router of RIOT flashed on the dongle</div>
<div class="line">│   ├── ip_address_dongle.md    # The IPv6-address and the interface name of dongle </div>
<div class="line">├── Doxyfiles/                  # The Doxyfile and configurations</div>
<div class="line">├── images/                     # The images</div>
<div class="line">├── TextYourIoTDevice/          # The code of TextYourIoTDevice flashed on the DK</div>
<div class="line">│   ├── led_utils.h             # Header file of led_utils</div>
<div class="line">│   ├── led_utils.c             # C file of led_utils</div>
<div class="line">│   ├── main.c                  # Main file</div>
<div class="line">│   ├── Makefile                # Main makefile</div>
<div class="line">│   ├── Makefile.board.dep      # Makefile of board.dep of RIOT</div>
<div class="line">│   ├── Makefile.ci             # Makefile of ci of RIOT</div>
<div class="line">│   ├── Makefile.gnrc           # Makefile of gnrc of RIOT</div>
<div class="line">│   ├── Makefile.Iwip           # Makefile of Iwip of RIOT</div>
<div class="line">│   ├── Makefile.mqtt           # Makefile of mqtt of RIOT</div>
<div class="line">│   ├── Makefile.saul           # Makefile of saul of RIOT</div>
<div class="line">│   ├── mqtt_utils.h            # Header file of mqtt_utils</div>
<div class="line">│   ├── saul_utils.h            # Header file of saul_utils</div>
<div class="line">│   ├── saul_utils.c            # C file of saul_utils</div>
<div class="line">│   ├── shell_command_utils.c   # C file of shell_command_utils</div>
<div class="line">└── README.md                   # This documentation</div>
</div><!-- fragment --> <h1><a class="anchor" id="autotoc_md33"></a>
🚀 &lt;strong&gt;Setup Instructions&lt;/strong&gt;</h1>
<h2><a class="anchor" id="autotoc_md34"></a>
&lt;strong&gt;1. Flashing the DK&lt;/strong&gt;</h2>
<ol type="1">
<li><p class="startli">Hardware Connections</p><ol type="a">
<li>Connect the sensor BME280 to DK as shown in the following photo:</li>
</ol>
<p class="startli"><img src="images/hardware_connections.png" alt="Hardware connections" class="inline"/></p>
<p class="startli"><b>BME280 Pinout (for I2C)</b>: </p><pre class="fragment">VCC (BME280) → 3.3V (nRF52840DK)
GND (BME280) → GND (nRF52840DK)
SDA (BME280) → SDA (Pin 26 on nRF52840DK)
SCL (BME280) → SCL (Pin 27 on nRF52840DK)
SDO (BME280) → GND (for I2C address 0x76) or 3.3V (for I2C address 0x77)
</pre></li>
</ol>
<p><b>Important NOTE</b>: The program is already flashed on the DK. If you still want to make it, go through the following steps.</p>
<ol type="1">
<li>Clone the project repository: <div class="fragment"><div class="line">git clone https://github.com/Hani-Rezaei/IoT-Chat-Digitalization.git</div>
</div><!-- fragment --></li>
<li>Into the directory <div class="fragment"><div class="line">cd directory/</div>
</div><!-- fragment --></li>
<li>Build the application for the nRF52840 DK: <div class="fragment"><div class="line">make BOARD=nrf52840dk TextYourIoTDevice/</div>
</div><!-- fragment --></li>
<li>Flash the firmware and verify the flashing process by checking the serial output: <div class="fragment"><div class="line">make BOARD=nrf52840dk TextYourIoTDevice/ flash term</div>
</div><!-- fragment --> </li>
</ol>
<h2><a class="anchor" id="autotoc_md35"></a>
&lt;strong&gt;2. Flashing the Dongle&lt;/strong&gt;</h2>
<ol type="1">
<li>Build the application for the Dongle: <div class="fragment"><div class="line">make BOARD=nrf52840dongle dongle/ all</div>
</div><!-- fragment --></li>
<li>Copy created build *.hex* <br  />
</li>
<li>Start the tool <a href="https://www.nordicsemi.com/Products/Development-tools/nRF-Connect-for-Desktop/Download#infotabs">nRF Connect for Desktop</a></li>
<li>Flash the firmware in dongle (see documentation for detailed instructions)</li>
</ol>
<h2><a class="anchor" id="autotoc_md36"></a>
&lt;strong&gt;3. The MQTT Broker on AWS EC2&lt;/strong&gt;</h2>
<p>The mqtt broker on AWS EC2 should work fine.</p>
<p>If it doesn't, contact developer or look at the documentation. to know how the broker was created and configured.</p>
<h2><a class="anchor" id="autotoc_md37"></a>
&lt;strong&gt;4. The MQTT Broker on AWS IoT Core&lt;/strong&gt;</h2>
<p>The mqtt broker on AWS IoT Core should work fine.</p>
<p>If it doesn't, contact developers or look at the documentation. to know how the broker was created and configured.</p>
<h2><a class="anchor" id="autotoc_md38"></a>
**5. The AWS Lambda &lt;em&gt;TelegramBotHandler***</h2>
<p>The AWS Lambda function *TelegramBotHandler should work fine.</p>
<p>If not, contact the developers or read the documentation to learn how the function was created and configured.</p>
<h2><a class="anchor" id="autotoc_md39"></a>
&lt;strong&gt;6. The AWS API Gateaway&lt;/strong&gt;</h2>
<p>The AWS API Gateaway should work fine.</p>
<p>If not, contact the developers or read the documentation to learn how the function was created and configured.</p>
<h2><a class="anchor" id="autotoc_md40"></a>
&lt;strong&gt;7. The Webhook&lt;/strong&gt;</h2>
<p>The Webhook should work fine.</p>
<p>If not, contact the developers or read the documentation to learn how the function was created and configured.</p>
<h2><a class="anchor" id="autotoc_md41"></a>
&lt;strong&gt;8. Telegram Bot&lt;/strong&gt;</h2>
<p>Using the Telegram Bot <b>TextYourIoTDevice</b> </p><div class="fragment"><div class="line">Username: @TextYourIoTDevicebot</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md42"></a>
📖 &lt;strong&gt;Documentation&lt;/strong&gt;</h1>
<p><b>1. Inline Code Documentation and code structur:</b></p>
<ul>
<li><b>Doxygen</b> is used for code-level documentation.<ol type="1">
<li>Doxygen <code>bash sudo apt install doxygen # Auf Linux &lt;br&gt; </code></li>
<li>Doxygen-Konfigurationsdatei generieren: <code>bash doxygen -g </code></li>
<li>Die generierte Doxyfile anpassen: <code>plaintext ~/Doxyfiles/Doxyfile </code></li>
<li>Doxygen ausführen: <code>bash doxygen Doxyfile </code></li>
<li>Die generierte Dokumentation wird im angegebenen <em>OUTPUT_DIRECTORY</em> gespeichert.</li>
<li>Im einem Browser, um die Dokumentation anzusehen: <code>bash xdg-open doc/html/index.html # Auf Linux </code></li>
</ol>
</li>
<li>If required, there is <b>inline code</b> in each file.</li>
</ul>
<p><b>2. README.md:</b> This documentation (detailed steps for setup and usage).</p>
<p><b>3. Final Documentation:</b> Comprehensive project report.</p>
<h1><a class="anchor" id="autotoc_md43"></a>
👨‍💻 &lt;strong&gt;Contact&lt;/strong&gt;</h1>
<ol type="1">
<li><p class="startli">Mohammadjavad Esmaeili</p>
<p class="startli">📧 Email: <a href="mohammadjavad.esmaeili@stud.fra-uas.de">mohammadjavad.esmaeili@stud.fra-uas.de</a></p>
</li>
</ol>
<ol type="1">
<li><p class="startli">Hani Rezaei</p>
<p class="startli">📧 Email: <a href="hani.rezaei@stud.fra-uas.de">hani.rezaei@stud.fra-uas.de</a> </p>
</li>
</ol>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
